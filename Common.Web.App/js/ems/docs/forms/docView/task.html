<ng-form class="form-inline" sc-validate="{}">

  <div ng-init="assignmentIsOpen = model.openAccordion || (model.docUnitsFrom.length > 0) || (model.docUnitsImportedBy.length > 0) || (model.docUnitsInCharge.length > 0) || (model.docUnitsControlling.length > 0) || !!model.assignmentType || !!model.assignmentDate || !!model.assignmentDeadline" ng-if="!readonly || (model.docUnitsFrom.length > 0) || (model.docUnitsImportedBy.length > 0) || (model.docUnitsInCharge.length > 0) || (model.docUnitsControlling.length > 0) || !!model.assignmentType || !!model.assignmentDate || !!model.assignmentDeadline">
    <h5 class="form-header" style="margin-top:10px;">
      <a l10n-text="docs.edit.view.assignment" ng-click="assignmentIsOpen = !assignmentIsOpen" style="cursor:pointer;"></a>
    </h5>
    <div ng-if="assignmentIsOpen">
      <div class="row">
        <sc-field-group class="col-md-6" text="docs.edit.view.docUnitsFrom" validations="{required: 'default', requiredValue: 'Задължително поле'}" field-name="docUnitsFrom">
          <sc-nomenclature name="docUnitsFrom" ng-model="model.docUnitsFrom" alias="'employeeUnit'" multiple="multiple" sc-validate="{ requiredValue: requireDocUnitsFrom }" required ng-readonly="readonly"></sc-nomenclature>
          <sc-button btn-click="$raise('scOnSelectUnit', { type: 'from' })" class="btn btn-default" icon="glyphicon glyphicon-search" ng-disabled="readonly"></sc-button>
        </sc-field-group>

        <sc-field-group class="col-md-6" text="docs.edit.view.importedBy">
          <sc-nomenclature ng-model="model.docUnitsImportedBy" alias="'employeeUnit'" multiple="multiple" ng-readonly="readonly"></sc-nomenclature>
          <sc-button btn-click="$raise('scOnSelectUnit', { type: 'importedBy' })" class="btn btn-default" icon="glyphicon glyphicon-search" ng-disabled="readonly"></sc-button>
        </sc-field-group>
      </div>

      <div class="row">
        <sc-field-group class="col-md-6" text="docs.edit.view.inCharge" validations="{required: 'default', requiredValue: 'Задължително поле'}" field-name="docUnitsInCharge">
          <sc-nomenclature name="docUnitsInCharge" ng-model="model.docUnitsInCharge" alias="'employeeUnit'" multiple="multiple" sc-validate="{ requiredValue: requireDocUnitsInCharge }" required ng-readonly="readonly"></sc-nomenclature>
          <sc-button btn-click="$raise('scOnSelectUnit', { type: 'inCharge' })" class="btn btn-default" icon="glyphicon glyphicon-search" ng-disabled="readonly"></sc-button>
        </sc-field-group>

        <sc-field-group class="col-md-6" text="docs.edit.view.controlling">
          <sc-nomenclature ng-model="model.docUnitsControlling" alias="'employeeUnit'" multiple="multiple" ng-readonly="readonly"></sc-nomenclature>
          <sc-button btn-click="$raise('scOnSelectUnit', { type: 'controlling' })" class="btn btn-default" icon="glyphicon glyphicon-search" ng-disabled="readonly"></sc-button>
        </sc-field-group>
      </div>

      <div class="row" style="margin-bottom: 5px;">
        <div class="form-group col-md-3" sc-has-error="assignmentType">
          <label class="control-label" l10n-text="docs.edit.view.assignmentType"></label>
          <sc-validation-error field-name="assignmentType" validations="{required: 'default'}"></sc-validation-error>
          <sc-nomenclature name="assignmentType" ng-model="model.assignmentTypeId" nom-obj="model.assignmentType" mode="id" alias="'assignmentType'" required ng-readonly="readonly"></sc-nomenclature>
        </div>

        <div class="form-group col-md-2">
          <label class="control-label" l10n-text="docs.edit.view.assignmentDate"></label>
          <sc-date name="assignmentDate" ng-model="model.assignmentDate" ng-readonly="readonly"></sc-date>
        </div>

        <div class="form-group col-md-2" sc-has-error="assignmentDeadline">
          <label class="control-label" l10n-text="docs.edit.view.assignmentDeadline"></label>
          <sc-validation-error field-name="assignmentDeadline" validations="{required: 'default', requiredValue: 'Задължително поле'}"></sc-validation-error>
          <sc-date name="assignmentDeadline" ng-model="model.assignmentDeadline" sc-validate="{ requiredValue: requireAssignmentDeadline }"ng-readonly="readonly"></sc-date>
        </div>
      </div>
    </div>
  </div>

  <div ng-init="permissionsIsOpen = model.openAccordion || (model.docUnitsCCopy.length > 0) || (model.docUnitsReaders.length > 0) || (model.docUnitsEditors.length > 0) || (model.docUnitsRegistrators.length > 0)" ng-if="!readonly || (model.docUnitsCCopy.length > 0) || (model.docUnitsReaders.length > 0) || (model.docUnitsEditors.length > 0) || (model.docUnitsRegistrators.length > 0)">
    <h5 class="form-header" style="margin-top:10px;">
      <a l10n-text="docs.edit.view.permissions" ng-click="permissionsIsOpen = !permissionsIsOpen" style="cursor:pointer;"></a>
    </h5>
    <div ng-if="permissionsIsOpen">
      <div class="row" style="margin-bottom: 5px;">
        <sc-field-group class="col-md-6" text="docs.edit.view.readers">
          <sc-nomenclature ng-model="model.docUnitsReaders" alias="'employeeUnit'" multiple="multiple" ng-readonly="readonly"></sc-nomenclature>
          <sc-button btn-click="$raise('scOnSelectUnit', { type: 'readers' })" class="btn btn-default" icon="glyphicon glyphicon-search" ng-disabled="readonly"></sc-button>
        </sc-field-group>

        <sc-field-group class="col-md-6" text="docs.edit.view.editors">
          <sc-nomenclature ng-model="model.docUnitsEditors" alias="'employeeUnit'" multiple="multiple" ng-readonly="readonly"></sc-nomenclature>
          <sc-button btn-click="$raise('scOnSelectUnit', { type: 'editors' })" class="btn btn-default" icon="glyphicon glyphicon-search" ng-disabled="readonly"></sc-button>
        </sc-field-group>
      </div>

      <div class="row" style="margin-bottom: 5px;">
        <sc-field-group class="col-md-6" text="docs.edit.view.cCopy">
          <sc-nomenclature ng-model="model.docUnitsCCopy" alias="'employeeUnit'" multiple="multiple" ng-readonly="readonly"></sc-nomenclature>
          <sc-button btn-click="$raise('scOnSelectUnit', { type: 'cCopy' })" class="btn btn-default" icon="glyphicon glyphicon-search" ng-disabled="readonly"></sc-button>
        </sc-field-group>

        <sc-field-group class="col-md-6" text="docs.edit.view.registrators">
          <sc-nomenclature ng-model="model.docUnitsRegistrators" alias="'employeeUnit'" multiple="multiple" ng-readonly="readonly"></sc-nomenclature>
          <sc-button btn-click="$raise('scOnSelectUnit', { type: 'registrators' })" class="btn btn-default" icon="glyphicon glyphicon-search" ng-disabled="readonly"></sc-button>
        </sc-field-group>
      </div>
    </div>
  </div>

  <div ng-init="textIsOpen = model.openAccordion || !!model.docBody" ng-if="!readonly || !!model.docBody">
    <h5 class="form-header" style="margin-top:10px;">
      <a l10n-text="docs.edit.view.text" ng-click="textIsOpen = !textIsOpen" style="cursor:pointer;"></a>
    </h5>
    <div ng-if="textIsOpen">
      <div class="row">
        <div class="col-md-12" style="margin-bottom: 5px;">
          <sc-textarea rows="2" ng-model="model.docBody" ng-readonly="readonly"></sc-textarea>
        </div>
      </div>
    </div>
  </div>

  <div ng-init="editableFileIsOpen = true" ng-if="model.jObjectForm">
    <h5 class="form-header" style="margin-top:10px;">
      <a l10n-text="docs.edit.view.editableFile" ng-click="editableFileIsOpen = !editableFileIsOpen" style="cursor:pointer;"></a>
    </h5>
    <div ng-if="editableFileIsOpen">
      <ems-removing-irregularity name="docFileRemovingIrregularity" ng-model="model" readonly="readonly" ng-if="model.jObjectForm === '0010-003010'"></ems-removing-irregularity>

      <ems-receipt-not-acknowledge name="docFileReceiptNotAcknowledge" ng-model="model" readonly="readonly" ng-if="model.jObjectForm === '0010-000001'"></ems-receipt-not-acknowledge>

      <ems-receipt-acknowledge name="docFileReceiptAcknowledge" ng-model="model" readonly="readonly" ng-if="model.jObjectForm === '0010-000002'"></ems-receipt-acknowledge>

      <ems-competence-transfer name="docFileCompetenceTransfer" ng-model="model" readonly="readonly" ng-if="model.jObjectForm === '0010-006064'"></ems-competence-transfer>
    </div>
  </div>

  <div ng-init="contentIsOpen = model.openAccordion || model.publicDocFiles.length > 0 || model.privateDocFiles.length > 0" ng-if="!readonly || model.publicDocFiles.length > 0 || model.privateDocFiles.length > 0">
    <h5 class="form-header" style="margin-top:10px;">
      <a l10n-text="docs.edit.view.content" ng-click="contentIsOpen = !contentIsOpen" style="cursor:pointer;"></a>
    </h5>
    <div ng-if="contentIsOpen">
      <ems-doc-files-view name="docFilesViewForm" ng-model="model" ng-if="readonly"></ems-doc-files-view>
      <ems-doc-files-edit name="docFilesForm" ng-model="model" readonly="readonly" ng-if="!readonly"></ems-doc-files-edit>
    </div>
  </div>

  <div ng-init="classificationIsOpen = model.openAccordion || model.docClassifications.length > 0" ng-if="!readonly || model.docClassifications.length > 0">
    <h5 class="form-header" style="margin-top:10px;">
      <a l10n-text="docs.edit.classifications.name" ng-click="classificationIsOpen = !classificationIsOpen" style="cursor:pointer;"></a>
    </h5>
    <div ng-if="classificationIsOpen">
      <ems-doc-view-doc-classification name="docClassificationForm" ng-model="model" readonly="readonly"></ems-doc-view-doc-classification>
    </div>
  </div>
</ng-form>
